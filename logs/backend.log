
> @smart-trolley/api@1.0.0 dev
> nodemon src/index.js

[33m[nodemon] 3.1.10[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): *.*[39m
[33m[nodemon] watching extensions: js,mjs,cjs,json[39m
[32m[nodemon] starting `node src/index.js`[39m
[Gemini] Configurado con modelo: gemini-robotics-er-1.5-preview
[Gemini] URL: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] Video stream namespace initialized at /ws

═══════════════════════════════════════════════════════
🚀 Smart Trolley API Server
═══════════════════════════════════════════════════════
✅ Server running on http://localhost:3001
✅ WebSocket available at ws://localhost:3001/ws
✅ Gemini Mode: 🤖 REAL (Production)
✅ Database: 🟢 Connected
═══════════════════════════════════════════════════════

📡 Endpoints:
   GET  /                          - API info
   GET  /health                    - Health check
   GET  /api/trolleys/:id/realtime-status
   GET  /api/trolleys/:id/detections
   GET  /api/scans/:id/summary

🎥 WebSocket Events:
   start_scan  - Iniciar grabación
   frame       - Enviar frame de video
   end_scan    - Finalizar grabación

👀 Listening for connections...

[WS] No token provided, using guest user (dev mode)
[WS] User guest connected (f85mibxLQ4iZoOcOAAAB)
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node src/index.js`[39m
[Gemini] Configurado con modelo: gemini-robotics-er-1.5-preview
[Gemini] URL: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] Video stream namespace initialized at /ws

═══════════════════════════════════════════════════════
🚀 Smart Trolley API Server
═══════════════════════════════════════════════════════
✅ Server running on http://localhost:3001
✅ WebSocket available at ws://localhost:3001/ws
✅ Gemini Mode: 🤖 REAL (Production)
✅ Database: 🟢 Connected
═══════════════════════════════════════════════════════

📡 Endpoints:
   GET  /                          - API info
   GET  /health                    - Health check
   GET  /api/trolleys/:id/realtime-status
   GET  /api/trolleys/:id/detections
   GET  /api/scans/:id/summary

🎥 WebSocket Events:
   start_scan  - Iniciar grabación
   frame       - Enviar frame de video
   end_scan    - Finalizar grabación

👀 Listening for connections...

[WS] No token provided, using guest user (dev mode)
[WS] User guest connected (nmhmYnNk9HFv75vcAAAB)
[WS] User guest disconnected (nmhmYnNk9HFv75vcAAAB)
[WS] No token provided, using guest user (dev mode)
[WS] User guest connected (EFtVOnPXaUDdcdBWAAAD)
[WS] Trolley 123 no existe, usando trolley por defecto
[WS] Operator 456 no existe, usando operator por defecto
[WS] Scan 15 started for trolley 1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_4_1761447890126',
  base64Length: 20700,
  timestamp: 1761447890129
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 0/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20700
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_5_1761447890644',
  base64Length: 20768,
  timestamp: 1761447890645
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 1/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20768
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_6_1761447891177',
  base64Length: 20892,
  timestamp: 1761447891179
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 2/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20892
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_7_1761447891695',
  base64Length: 20872,
  timestamp: 1761447891696
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 3/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20872
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_8_1761447892215',
  base64Length: 22444,
  timestamp: 1761447892216
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 4/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22444
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"1I_9aIuXGpDRz7IP5Jq_MA"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"1I_9aPPAH9qfz7IP89CBuAU"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_9_1761447892742',
  base64Length: 25848,
  timestamp: 1761447892745
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 5/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25848
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"1I_9aPmMPNSHz7IPo__T0AY"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_10_1761447893265',
  base64Length: 28832,
  timestamp: 1761447893266
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 6/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28832
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"1Y_9aMKOI77oz7IPrtSAeA"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_11_1761447893786',
  base64Length: 29408,
  timestamp: 1761447893792
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"1Y_9aOPxM_jVz7IPytiXkAw"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 7/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29408
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_12_1761447894310',
  base64Length: 29544,
  timestamp: 1761447894312
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"1o_9aKWGGrGtz7IP-6bI4QE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 8/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29544
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_13_1761447894843',
  base64Length: 29580,
  timestamp: 1761447894845
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 9/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29580
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"14_9aPKSEKLSz7IP2qCQ8Ac"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_14_1761447895368',
  base64Length: 29604,
  timestamp: 1761447895370
}
[WS] ✅ Producto NUEVO registrado: Coca-Cola Regular Lata (confidence: 0.95)
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"14_9aLbZIe-tz7IPhOf56AE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 10/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29604
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_15_1761447895893',
  base64Length: 29156,
  timestamp: 1761447895895
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 11/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29156
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_16_1761447896419',
  base64Length: 29656,
  timestamp: 1761447896421
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"2I_9aILzHMifz7IP7c26IA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 12/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29656
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_17_1761447896944',
  base64Length: 29432,
  timestamp: 1761447896948
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 13/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29432
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"2Y_9aNajDeSJz7IPlJCZ6QY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_18_1761447897471',
  base64Length: 29104,
  timestamp: 1761447897473
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 14/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29104
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"2Y_9aOHrOKrUz7IP6qybmQg"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_19_1761447897992',
  base64Length: 29216,
  timestamp: 1761447897994
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"2o_9aKCrCJDRz7IP5Jq_MA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 15/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29216
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_20_1761447898517',
  base64Length: 29300,
  timestamp: 1761447898518
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 16/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29300
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"2o_9aO-eOJ7oz7IP06qvaQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_21_1761447899044',
  base64Length: 29308,
  timestamp: 1761447899045
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"24_9aOO7CI-Hz7IP7JWUgQk"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 17/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29308
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"24_9aN-1FYDVz7IPmrDmMQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_22_1761447899570',
  base64Length: 29276,
  timestamp: 1761447899572
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"24_9aI3JJKisz7IPh8GskAU"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 18/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29276
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_23_1761447900094',
  base64Length: 28008,
  timestamp: 1761447900096
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"3I_9aIunEeetz7IP-_G1gAk"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 19/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28008
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_24_1761447900618',
  base64Length: 28600,
  timestamp: 1761447900620
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 20/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28600
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_25_1761447901143',
  base64Length: 28644,
  timestamp: 1761447901144
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"3Y_9aJWrFInRz7IPnKTY-AM"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 21/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28644
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"3Y_9aPy5G43jz7IP7omggQE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_26_1761447901665',
  base64Length: 28680,
  timestamp: 1761447901666
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"3Y_9aOroKdWGz7IPw7jU0QU"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 22/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28680
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_27_1761447902185',
  base64Length: 29008,
  timestamp: 1761447902186
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"3o_9aPH_EcGtz7IPqYnpMQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 23/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29008
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_28_1761447902709',
  base64Length: 25716,
  timestamp: 1761447902711
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 24/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25716
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"34_9aNzTAbuDz7IP4MChQA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_29_1761447903236',
  base64Length: 22636,
  timestamp: 1761447903238
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 25/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22636
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"34_9aK6-IIbpz7IP68StqAY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_30_1761447903748',
  base64Length: 23352,
  timestamp: 1761447903749
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"34_9aOOKO43jz7IP7omggQE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 26/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23352
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_31_1761447904270',
  base64Length: 23384,
  timestamp: 1761447904272
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 27/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23384
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"4I_9aIHRIaKez7IP8a_cSA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_32_1761447904794',
  base64Length: 23280,
  timestamp: 1761447904796
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"4I_9aIXYPOPRz7IPtKGjOQ"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 28/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23280
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_33_1761447905321',
  base64Length: 25088,
  timestamp: 1761447905323
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"4Y_9aMKQHcifz7IP7c26IA"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 29/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25088
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_34_1761447905844',
  base64Length: 27292,
  timestamp: 1761447905846
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"4Y_9aMjpNavTz7IP8eHrOQ"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 30/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 27292
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"4o_9aMPdDtThz7IPma_TuQU"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_35_1761447906370',
  base64Length: 28028,
  timestamp: 1761447906372
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 31/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28028
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_36_1761447906895',
  base64Length: 28408,
  timestamp: 1761447906897
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 32/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28408
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"44_9aJvrCcGtz7IPjumZ8AM"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_37_1761447907428',
  base64Length: 28436,
  timestamp: 1761447907430
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"44_9aMb_I7Gtz7IP-6bI4QE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 33/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28436
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_38_1761447907955',
  base64Length: 28144,
  timestamp: 1761447907957
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"5I_9aILnCr7oz7IPsdSAeA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 34/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28144
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_39_1761447908482',
  base64Length: 27924,
  timestamp: 1761447908484
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 35/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 27924
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"5I_9aN_dMuvjz7IPh4uugAE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_40_1761447909010',
  base64Length: 28288,
  timestamp: 1761447909012
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 36/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28288
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"5Y_9aI-JDInRz7IPnKTY-AM"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_41_1761447909536',
  base64Length: 27556,
  timestamp: 1761447909538
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 37/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 27556
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"5Y_9aNDPNr7gz7IP9_yE6Ac"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_42_1761447910061',
  base64Length: 27548,
  timestamp: 1761447910063
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 38/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 27548
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"5o_9aMP0FYjQz7IPjoTIOQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_43_1761447910590',
  base64Length: 27584,
  timestamp: 1761447910591
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"5o_9aPDNLOGJz7IPkb27gAw"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 39/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 27584
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_44_1761447911115',
  base64Length: 27768,
  timestamp: 1761447911117
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"54_9aM_pDYjQz7IPjoTIOQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 40/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 27768
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_45_1761447911642',
  base64Length: 21768,
  timestamp: 1761447911644
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 41/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21768
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"54_9aOeIO6vTz7IP8eHrOQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_46_1761447912164',
  base64Length: 20760,
  timestamp: 1761447912165
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"6I_9aISME6jgz7IP25TbwAk"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 42/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20760
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_47_1761447912692',
  base64Length: 20012,
  timestamp: 1761447912694
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"6I_9aNCbLvHoz7IP_OSyQQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 43/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20012
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_48_1761447913214',
  base64Length: 20480,
  timestamp: 1761447913216
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"6Y_9aNnuGsfVz7IP9pKoOA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 44/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20480
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"6Y_9aIiSHILoz7IPoODXoQU"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_49_1761447913743',
  base64Length: 21308,
  timestamp: 1761447913745
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 45/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21308
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_50_1761447914266',
  base64Length: 25844,
  timestamp: 1761447914267
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"6o_9aKmIE--tz7IPhOf56AE"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 46/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25844
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"6o_9aNe-K_Gtz7IPhdCROQ"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_51_1761447914787',
  base64Length: 28592,
  timestamp: 1761447914788
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 47/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28592
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_52_1761447915312',
  base64Length: 28396,
  timestamp: 1761447915314
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"64_9aP67HPbXz7IPxLex2QU"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 48/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28396
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_53_1761447915836',
  base64Length: 28572,
  timestamp: 1761447915838
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"64_9aI_hNaDpz7IPmLfx-QY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 49/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28572
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_54_1761447916350',
  base64Length: 28676,
  timestamp: 1761447916352
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"7I_9aJ6yIOetz7IP-_G1gAk"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 50/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28676
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"7I_9aOePKbvQz7IPxoi3UA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_55_1761447916876',
  base64Length: 28536,
  timestamp: 1761447916878
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 51/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28536
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_56_1761447917397',
  base64Length: 28372,
  timestamp: 1761447917399
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 52/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 28372
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"7Y_9aODvKpDRz7IP5Jq_MA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_57_1761447917924',
  base64Length: 24436,
  timestamp: 1761447917927
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"7o_9aKXMAuGJz7IPkb27gAw"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 53/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24436
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"7o_9aK2kDb3oz7IPgceoYA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_58_1761447918460',
  base64Length: 20780,
  timestamp: 1761447918463
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 54/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20780
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_59_1761447918981',
  base64Length: 21460,
  timestamp: 1761447918982
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 55/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21460
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"74_9aKOzEP_4qtsPt5OXsAc"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"74_9aPCEF7uDz7IP4MChQA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_60_1761447919501',
  base64Length: 22000,
  timestamp: 1761447919502
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 56/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22000
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_61_1761447920027',
  base64Length: 23212,
  timestamp: 1761447920029
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"8I_9aJD5A_jVz7IPytiXkAw"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 57/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23212
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_62_1761447920554',
  base64Length: 23660,
  timestamp: 1761447920556
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"8I_9aOneILjiz7IPt6rlsQU"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 58/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23660
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"8Y_9aLydAvbXz7IPxLex2QU"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_63_1761447921077',
  base64Length: 23988,
  timestamp: 1761447921084
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 59/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23988
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] ✅ Producto NUEVO registrado: Coca-Cola Light Lata (confidence: 0.95)
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_64_1761447921608',
  base64Length: 24136,
  timestamp: 1761447921610
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 60/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24136
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"8Y_9aMuCOObpz7IPlpbhWQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_65_1761447922127',
  base64Length: 24484,
  timestamp: 1761447922128
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"8o_9aKnhD6DUz7IPv4PK4AY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 61/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24484
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_66_1761447922655',
  base64Length: 24100,
  timestamp: 1761447922657
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 62/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24100
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_67_1761447923179',
  base64Length: 23840,
  timestamp: 1761447923185
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"84_9aNLFFaisz7IPh8GskAU"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 63/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23840
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"84_9aM2yJK22qtsP1oYS"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_68_1761447923707',
  base64Length: 22568,
  timestamp: 1761447923709
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"84_9aMD3NP6tz7IPlZCc8Qs"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 64/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22568
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_69_1761447924230',
  base64Length: 21728,
  timestamp: 1761447924232
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 65/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21728
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"9I_9aISEIrbhz7IPlfamyAY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_70_1761447924759',
  base64Length: 22064,
  timestamp: 1761447924761
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 66/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22064
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"9Y_9aLvBApngz7IPh7q2KA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_71_1761447925281',
  base64Length: 21948,
  timestamp: 1761447925283
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 67/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21948
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"9Y_9aN3pLObQz7IP5-G3yAY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 🗑️ Productos removidos del frame: 1
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"9Y_9aJWxL_mRmtkPxv3FAQ"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_72_1761447925809',
  base64Length: 21556,
  timestamp: 1761447925811
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 68/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21556
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] ✅ Producto NUEVO registrado: Coca-Cola Regular Lata (confidence: 0.95)
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"9o_9aOmfEdSHz7IPo__T0AY"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_73_1761447926333',
  base64Length: 27668,
  timestamp: 1761447926334
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 69/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 27668
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_74_1761447926859',
  base64Length: 29456,
  timestamp: 1761447926861
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"9o_9aLWwOO-tz7IPiov-yA8"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"94_9aMedBd6DqtsPoLnSCA"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 70/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29456
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_75_1761447927386',
  base64Length: 25484,
  timestamp: 1761447927388
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 71/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25484
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_76_1761447927911',
  base64Length: 21356,
  timestamp: 1761447927913
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"94_9aKvzNeSJz7IPlJCZ6QY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 72/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21356
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_77_1761447928438',
  base64Length: 21900,
  timestamp: 1761447928439
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"-I_9aJj2Gt2VmtkPo8jo-Q8"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 73/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21900
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"-I_9aLCzNdWGz7IPw7jU0QU"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_78_1761447928966',
  base64Length: 21828,
  timestamp: 1761447928968
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"-Y_9aL-uCP6tz7IPlZCc8Qs"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 74/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21828
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_79_1761447929494',
  base64Length: 22336,
  timestamp: 1761447929495
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"-Y_9aOKUIqPnqtsPh8GPuAg"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 75/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22336
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_80_1761447930020',
  base64Length: 24724,
  timestamp: 1761447930022
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"-o_9aIyMD5ngz7IPw4SpiAE"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 76/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24724
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_81_1761447930543',
  base64Length: 24324,
  timestamp: 1761447930545
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 77/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24324
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"-o_9aID4OunlqtsPvrWH2AQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_82_1761447931069',
  base64Length: 23980,
  timestamp: 1761447931072
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 78/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23980
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_83_1761447931595',
  base64Length: 23452,
  timestamp: 1761447931597
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"-4_9aPDUJKrUz7IP6qybmQg"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"-4_9aOygNv7gz7IPg_PTqAI"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Producto NUEVO registrado: Coca-Cola Light Lata (confidence: 0.95)
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 79/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23452
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_84_1761447932126',
  base64Length: 22216,
  timestamp: 1761447932127
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 80/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22216
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_85_1761447932651',
  base64Length: 21216,
  timestamp: 1761447932653
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_I_9aPz-K6XoqtsPioqHsAE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 81/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21216
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_Y_9aPWoB_Hgz7IPw_u8sAk"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_86_1761447933178',
  base64Length: 21252,
  timestamp: 1761447933180
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 82/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21252
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_Y_9aOzkJo-Hz7IP8KCb0QU"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_87_1761447933706',
  base64Length: 20296,
  timestamp: 1761447933708
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 83/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20296
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_o_9aMuXBLivmtkPoNSR-Qc"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_88_1761447934231',
  base64Length: 23792,
  timestamp: 1761447934232
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 84/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23792
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_89_1761447934759',
  base64Length: 29552,
  timestamp: 1761447934761
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_o_9aNDWN8XRz7IPzsTKMA"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 85/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29552
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_90_1761447935287',
  base64Length: 31044,
  timestamp: 1761447935289
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 86/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 31044
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_4_9aMfHJe-tz7IPhOf56AE"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_91_1761447935811',
  base64Length: 31156,
  timestamp: 1761447935813
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 87/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 31156
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_92_1761447936338',
  base64Length: 31300,
  timestamp: 1761447936339
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"AJD9aNG5F46fqtsP7c3P-QY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 88/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 31300
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] ✅ Producto NUEVO registrado: Coca-Cola Regular Lata (confidence: 0.95)
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_93_1761447936850',
  base64Length: 31268,
  timestamp: 1761447936851
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"A
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 1/2
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 89/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 31268
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] ✅ Producto NUEVO registrado: Coca-Cola Light Lata (confidence: 0.95)
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_94_1761447937361',
  base64Length: 31992,
  timestamp: 1761447937362
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"A
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/2
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 90/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 31992
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_95_1761447937885',
  base64Length: 31500,
  timestamp: 1761447937887
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"A
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/2
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 91/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 31500
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"A
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/2
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_96_1761447938401',
  base64Length: 23952,
  timestamp: 1761447938403
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 92/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23952
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"A
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/2
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_97_1761447938919',
  base64Length: 20548,
  timestamp: 1761447938922
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 93/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20548
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"A
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/2
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_98_1761447939436',
  base64Length: 20948,
  timestamp: 1761447939438
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 94/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20948
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"A
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/2
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_99_1761447939971',
  base64Length: 20648,
  timestamp: 1761447939973
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BJD9aJetCui7qtsP4IDEkQg"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 95/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20648
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_100_1761447940484',
  base64Length: 20420,
  timestamp: 1761447940486
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 96/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20420
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BJD9aMCJMaDpz7IPmLfx-QY"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_101_1761447941010',
  base64Length: 20564,
  timestamp: 1761447941012
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BZD9aMKYBqPnqtsPjcGPuAg"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 97/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20564
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_102_1761447941537',
  base64Length: 20760,
  timestamp: 1761447941539
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BZD9aOO-I7eMmtkPg5magAc"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 98/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20760
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BZD9aLLVL--tz7IPiov-yA8"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_103_1761447942062',
  base64Length: 20844,
  timestamp: 1761447942064
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 99/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20844
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BpD9aI2WIfmRmtkPxv3FAQ"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_104_1761447942594',
  base64Length: 22608,
  timestamp: 1761447942596
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BpD9aIWaMa2AmtkP-YqiCA"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 100/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22608
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_105_1761447943116',
  base64Length: 26252,
  timestamp: 1761447943117
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"B5D9aI-aFIbpz7IP68StqAY"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 101/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26252
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_106_1761447943644',
  base64Length: 26244,
  timestamp: 1761447943646
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 102/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26244
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"CJD9aKqOA6LiqtsPhZ2F-AY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_107_1761447944164',
  base64Length: 26124,
  timestamp: 1761447944164
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 103/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26124
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_108_1761447944680',
  base64Length: 26928,
  timestamp: 1761447944681
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 104/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26928
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"CZD9aIO0COCfz7IPzsa50AY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_109_1761447945202',
  base64Length: 26872,
  timestamp: 1761447945203
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"CZD9aNu0Dei7qtsP4IDEkQg"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 105/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26872
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"CZD9aPv4IvammtkP5LDvuA8"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_110_1761447945728',
  base64Length: 26724,
  timestamp: 1761447945730
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 106/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26724
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_111_1761447946251',
  base64Length: 22140,
  timestamp: 1761447946253
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"CpD9aKyyHI-Hz7IP8KCb0QU"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 107/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22140
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_112_1761447946777',
  base64Length: 21164,
  timestamp: 1761447946779
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 108/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21164
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_113_1761447947310',
  base64Length: 21220,
  timestamp: 1761447947312
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"C5D9aPWWHZfzqtsPvq-imQY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 109/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21220
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_114_1761447947836',
  base64Length: 21708,
  timestamp: 1761447947838
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DJD9aLbnA4bpz7IP68StqAY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 110/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21708
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DJD9aKyHDO2CqtsPi_zIgAk"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DJD9aMHqE9TQz7IP-tu8OQ"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_115_1761447948361',
  base64Length: 22112,
  timestamp: 1761447948363
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 111/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22112
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 15,
  frameId: 'frame_116_1761447948882',
  base64Length: 21696,
  timestamp: 1761447948884
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 112/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21696
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DZD9aJ-hBvCsmtkPmMVV"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 🧹 Tracking de productos visibles limpiado para scan 15
[WS] Scan 15 ended
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DZD9aNW1I-KCz7IPxqO3mAk"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DpD9aJzXBdP5qtsP6b-EiAs"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DpD9aNDEMM2oqtsPqYs3"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] User guest disconnected (EFtVOnPXaUDdcdBWAAAD)
[WS] No token provided, using guest user (dev mode)
[WS] User guest connected (9SVYEZrqVUfkKDJ5AAAF)
[WS] Trolley 123 no existe, usando trolley por defecto
[WS] Operator 456 no existe, usando operator por defecto
[WS] Scan 16 started for trolley 1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_118_1761448040595',
  base64Length: 20876,
  timestamp: 1761448040596
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 0/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20876
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_119_1761448041118',
  base64Length: 19528,
  timestamp: 1761448041120
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 1/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19528
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_120_1761448041636',
  base64Length: 19804,
  timestamp: 1761448041638
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 2/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19804
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_121_1761448042165',
  base64Length: 20044,
  timestamp: 1761448042165
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 3/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20044
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_122_1761448042692',
  base64Length: 23052,
  timestamp: 1761448042693
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"apD9aMSgNLivmtkPoNSR-Qc"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 4/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23052
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_123_1761448043220',
  base64Length: 26392,
  timestamp: 1761448043222
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"a5D9aNyqEfyMqtsPyPGH4AE"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 5/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26392
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"a5D9aNfpKKPnqtsP_8CPuAg"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_124_1761448043744',
  base64Length: 26808,
  timestamp: 1761448043746
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 6/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26808
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"bJD9aILQB4SsmtkPs6GkyAg"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_125_1761448044267',
  base64Length: 26748,
  timestamp: 1761448044268
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"bJD9aMOnG92VmtkPo8jo-Q8"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 7/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26748
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_126_1761448044794',
  base64Length: 26728,
  timestamp: 1761448044796
}
[WS] ✅ Producto NUEVO registrado: Coca-Cola Regular Lata (confidence: 0.95)
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"bJD9aOiGN4KIqtsP5NO3oAg"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 8/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26728
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_127_1761448045327',
  base64Length: 26956,
  timestamp: 1761448045329
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 9/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26956
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"bZD9aJHwKd-kqtsPu844"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_128_1761448045853',
  base64Length: 25792,
  timestamp: 1761448045855
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 10/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25792
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"bpD9aNTZDYSsmtkPs6GkyAg"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_129_1761448046377',
  base64Length: 20696,
  timestamp: 1761448046378
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"bpD9aJiiJKqHqtsPpYmI-Q8"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 11/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20696
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_130_1761448046903',
  base64Length: 19832,
  timestamp: 1761448046905
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 12/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19832
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"b5D9aOmbCsaCmtkP0cvV-A8"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_131_1761448047428',
  base64Length: 20048,
  timestamp: 1761448047430
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"b5D9aKrRJvHdqtsP74zkwAc"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 13/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20048
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_132_1761448047957',
  base64Length: 19784,
  timestamp: 1761448047959
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"b5D9aKj2OYuBqtsPt4KNkAI"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 14/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19784
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"cJD9aPn5GO2CqtsPi_zIgAk"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_133_1761448048483',
  base64Length: 19544,
  timestamp: 1761448048485
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 15/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19544
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_134_1761448049009',
  base64Length: 18956,
  timestamp: 1761448049011
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"cJD9aPXQPLaeqtsPn-nJgQc"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 16/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 18956
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_135_1761448049538',
  base64Length: 18880,
  timestamp: 1761448049539
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"cZD9aP6jK6GJqtsPlp23-A8"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 17/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 18880
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_136_1761448050051',
  base64Length: 19796,
  timestamp: 1761448050053
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"cpD9aLb8A5z4qtsPjPa1EA"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 18/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19796
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_137_1761448050569',
  base64Length: 20056,
  timestamp: 1761448050571
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"cpD9aOSFJYSsmtkPs6GkyAg"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 19/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20056
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_138_1761448051097',
  base64Length: 20132,
  timestamp: 1761448051098
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"c5D9aLWaEcqmmtkPxaDKsAs"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 20/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20132
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_139_1761448051625',
  base64Length: 19692,
  timestamp: 1761448051627
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"c5D9aL2qJ42qqtsP-sShmAc"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 21/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19692
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"dJD9aI4srKeq2w-4_Y0I"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_140_1761448052147',
  base64Length: 20024,
  timestamp: 1761448052148
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 22/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20024
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"dJD9aIf1Ier9qtsP-u2h-A8"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_141_1761448052677',
  base64Length: 24292,
  timestamp: 1761448052679
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 23/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24292
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"dZD9aILqCKCaqtsPkfjX6QE"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_142_1761448053204',
  base64Length: 24808,
  timestamp: 1761448053206
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 24/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24808
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_143_1761448053727',
  base64Length: 25340,
  timestamp: 1761448053729
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"dZD9aOCdN8ifz7IP7c26IA"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 25/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25340
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_144_1761448054249',
  base64Length: 25560,
  timestamp: 1761448054251
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 26/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25560
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_145_1761448054777',
  base64Length: 25536,
  timestamp: 1761448054779
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"d5D9aI8frYCa2Q_5iqII"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 27/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25536
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_146_1761448055303',
  base64Length: 25624,
  timestamp: 1761448055305
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"d5D9aLigEZClmtkPpJ2sGA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"d5D9aOvrGo-Hz7IP7JWUgQk"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 28/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25624
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_147_1761448055828',
  base64Length: 25412,
  timestamp: 1761448055830
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 29/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25412
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"eJD9aIfSDMXRz7IPzsTKMA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_148_1761448056361',
  base64Length: 25360,
  timestamp: 1761448056363
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 30/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25360
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"eJD9aPC_J5eI6dkPjfGu8Aw"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_149_1761448056878',
  base64Length: 25272,
  timestamp: 1761448056878
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 31/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25272
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"eZD9aMblEbbhz7IPlfamyAY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_150_1761448057394',
  base64Length: 25284,
  timestamp: 1761448057395
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"eZD9aJ-9GOe2mtkPwdDC8QE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 32/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25284
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_151_1761448057921',
  base64Length: 25020,
  timestamp: 1761448057923
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 33/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25020
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"epD9aKuiCo-Hz7IP8KCb0QU"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_152_1761448058443',
  base64Length: 22336,
  timestamp: 1761448058445
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 34/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22336
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"epD9aNCRMp6J6dkP842j-AI"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_153_1761448058961',
  base64Length: 19888,
  timestamp: 1761448058963
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"epD9aKXiOfHdqtsP74zkwAc"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 35/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19888
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_154_1761448059487',
  base64Length: 20280,
  timestamp: 1761448059489
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 36/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20280
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"e5D9aMPaMdqKqtsP---xwAg"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_155_1761448060012',
  base64Length: 20760,
  timestamp: 1761448060014
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 37/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20760
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_156_1761448060539',
  base64Length: 23880,
  timestamp: 1761448060541
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"fJD9aIOGJZngz7IPw4SpiAE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 38/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23880
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_157_1761448061067',
  base64Length: 25012,
  timestamp: 1761448061069
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 39/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25012
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_158_1761448061594',
  base64Length: 25028,
  timestamp: 1761448061596
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"fZD9aLbJKoTwqtsP0pewuAg"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"fZD9aP-kLoniqtsP4J-PuAc"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 40/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25028
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_159_1761448062119',
  base64Length: 24512,
  timestamp: 1761448062121
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 41/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24512
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"fpD9aNGbIfCsmtkPmMVV"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"fpD9aJf_IqKez7IP8a_cSA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_160_1761448062644',
  base64Length: 24508,
  timestamp: 1761448062647
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] ✅ Producto NUEVO registrado: Coca-Cola Light Lata (confidence: 0.95)
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 42/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24508
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_161_1761448063171',
  base64Length: 24352,
  timestamp: 1761448063173
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"f5D9aNvRDvmRmtkPxv3FAQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 43/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24352
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"holding\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":23,"totalTokenCount":790,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"f5D9aITPG5eI6dkPjfGu8Aw"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"holding"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"none","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ⚠️ Wrong action: none, expected placing_in_trolley
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_162_1761448063698',
  base64Length: 24176,
  timestamp: 1761448063700
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 44/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24176
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"gJD9aL34A9bZqtsP34Cc4QE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_163_1761448064226',
  base64Length: 23076,
  timestamp: 1761448064227
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 45/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23076
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"gJD9aIOjGuGJz7IPkb27gAw"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_164_1761448064757',
  base64Length: 26408,
  timestamp: 1761448064758
}
[WS] ✅ Producto NUEVO registrado: Coca-Cola Regular Lata (confidence: 0.95)
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 46/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26408
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"gZD9aMylAtP5qtsP6b-EiAs"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_165_1761448065293',
  base64Length: 26800,
  timestamp: 1761448065295
}
[WS] ✅ Producto NUEVO registrado: Coca-Cola Light Lata (confidence: 0.95)
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 47/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26800
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"gZD9aM3RJbOUmtkPreLu2Qc"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Light Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_166_1761448065816',
  base64Length: 22720,
  timestamp: 1761448065818
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 48/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22720
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"gpD9aMbTBKLiqtsPotqF2Ak"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_167_1761448066344',
  base64Length: 30224,
  timestamp: 1761448066346
}
[WS] ✅ Producto NUEVO registrado: Coca-Cola Regular Lata (confidence: 0.95)
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 49/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 30224
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"gpD9aMasJbuDz7IP4MChQA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_168_1761448066871',
  base64Length: 30952,
  timestamp: 1761448066873
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"g5D9aIzXAaGJqtsPlp23-A8"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 50/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 30952
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_169_1761448067395',
  base64Length: 30764,
  timestamp: 1761448067397
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"g5D9aJz0GJCKmtkPlryVoAc"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 51/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 30764
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_170_1761448067923',
  base64Length: 30104,
  timestamp: 1761448067925
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 52/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 30104
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"h
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 1/2
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_171_1761448068449',
  base64Length: 19940,
  timestamp: 1761448068451
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] ✅ Producto NUEVO registrado: Coca-Cola Light Lata (confidence: 0.95)
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"h
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/2
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 53/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19940
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_172_1761448068960',
  base64Length: 20344,
  timestamp: 1761448068961
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 54/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20344
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"h
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/2
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_173_1761448069481',
  base64Length: 20408,
  timestamp: 1761448069482
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"hZD9aJmyK6LiqtsPotqF2Ak"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 55/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20408
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"hZD9aL6-NovVz7IPi-HpMA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_174_1761448070010',
  base64Length: 24152,
  timestamp: 1761448070012
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 56/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24152
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"hpD9aN3UF7m9qtsPqZuh-A8"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_175_1761448070548',
  base64Length: 26128,
  timestamp: 1761448070548
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 57/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26128
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"hpD9aNSRO6HjqtsPl_atEA"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_176_1761448071075',
  base64Length: 21292,
  timestamp: 1761448071077
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 58/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21292
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_177_1761448071597',
  base64Length: 23296,
  timestamp: 1761448071598
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 59/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23296
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"iJD9aM7BAajgz7IP25TbwAk"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_178_1761448072125',
  base64Length: 24864,
  timestamp: 1761448072127
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"iJD9aMv0FYniqtsP4J-PuAc"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 60/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24864
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"iJD9aLfnJM2oqtsPqYs3"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_179_1761448072653',
  base64Length: 25132,
  timestamp: 1761448072655
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 61/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25132
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_180_1761448073178',
  base64Length: 25776,
  timestamp: 1761448073181
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"iZD9aKyIDrD7qtsPi7eLkAc"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 62/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25776
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_181_1761448073708',
  base64Length: 23832,
  timestamp: 1761448073710
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 63/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23832
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"ipD9aOddpeiq2w-KioewAQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_182_1761448074232',
  base64Length: 26900,
  timestamp: 1761448074233
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"ipD9aMTzFd6KmtkPtuq-0Ag"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 64/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26900
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_183_1761448074761',
  base64Length: 25708,
  timestamp: 1761448074763
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"ipD9aKTWM5z4qtsPjPa1EA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 65/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25708
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_184_1761448075289',
  base64Length: 25236,
  timestamp: 1761448075291
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 66/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25236
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.9},{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":38,"totalTokenCount":805,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"i5
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.9},{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.9,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.9},{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.9,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.9 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.9,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.9 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 1/2
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_185_1761448075827',
  base64Length: 25272,
  timestamp: 1761448075829
}
[WS] ✅ Producto NUEVO registrado: Coca-Cola Light Lata (confidence: 0.90)
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 67/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25272
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_186_1761448076353',
  base64Length: 25088,
  timestamp: 1761448076355
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.9}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":38,"totalTokenCount":805,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"jJ
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95},{"name":"Coca-Cola Light Lata","confidence":0.9}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95},{"name":"Coca-Cola Light Lata","confidence":0.9}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 },
    { name: 'Coca-Cola Light Lata', confidence: 0.9 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 },
    { name: 'Coca-Cola Light Lata', confidence: 0.9 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/2
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 68/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25088
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"jJD9aKHXKNe2qtsPsMWrCA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_187_1761448076879',
  base64Length: 29220,
  timestamp: 1761448076881
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 69/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 29220
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_188_1761448077408',
  base64Length: 24548,
  timestamp: 1761448077410
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 70/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24548
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.85}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"j
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95},{"name":"Coca-Cola Light Lata","confidence":0.85}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95},{"name":"Coca-Cola Light Lata","confidence":0.85}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 },
    { name: 'Coca-Cola Light Lata', confidence: 0.85 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 },
    { name: 'Coca-Cola Light Lata', confidence: 0.85 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 1/2
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"jZD9aI7-M43jz7IP7omggQE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_189_1761448077943',
  base64Length: 20264,
  timestamp: 1761448077944
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] ✅ Producto NUEVO registrado: Coca-Cola Light Lata (confidence: 0.85)
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 71/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20264
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"j
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Light Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Light Lata","confidence":0.95},{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Light Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Light Lata', confidence: 0.95 },
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 1/2
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_190_1761448078462',
  base64Length: 20100,
  timestamp: 1761448078464
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] ✅ Producto NUEVO registrado: Coca-Cola Light Lata (confidence: 0.95)
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 72/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20100
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_191_1761448078990',
  base64Length: 20204,
  timestamp: 1761448078992
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95},{\"name\":\"Coca-Cola Light Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":39,"totalTokenCount":806,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"j
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95},{"name":"Coca-Cola Light Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95},{"name":"Coca-Cola Light Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 },
    { name: 'Coca-Cola Light Lata', confidence: 0.95 }
  ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [
    { name: 'Coca-Cola Regular Lata', confidence: 0.95 },
    { name: 'Coca-Cola Light Lata', confidence: 0.95 }
  ]
}
[WS] 📦 Items detectados en frame actual: 2
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] ♻️ Coca-Cola Light Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/2
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 73/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20204
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_192_1761448079520',
  base64Length: 20396,
  timestamp: 1761448079522
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"j5D9aP2zJfv5qtsP_KriCA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 74/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20396
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"j5D9aKmXL__4qtsPt5OXsAc"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"j5D9aNrMMKDUz7IPv4PK4AY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_193_1761448080041',
  base64Length: 19704,
  timestamp: 1761448080043
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 75/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19704
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 16,
  frameId: 'frame_194_1761448080569',
  base64Length: 19868,
  timestamp: 1761448080571
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"kJD9aNaIIue2mtkPwdDC8QE"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 76/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19868
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 🧹 Tracking de productos visibles limpiado para scan 16
[WS] Scan 16 ended
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"kZD9aMLUCY6fqtsP7c3P-QY"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"kZD9aIyJJ_Hgz7IPw_u8sAk"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"kpD9aI01i4Gq2w-3go2QAg"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] User guest disconnected (9SVYEZrqVUfkKDJ5AAAF)
[WS] No token provided, using guest user (dev mode)
[WS] User guest connected (iNTlaScQpsASLvDeAAAH)
[WS] Trolley 123 no existe, usando trolley por defecto
[WS] Operator 456 no existe, usando operator por defecto
[WS] Scan 17 started for trolley 1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_196_1761448186314',
  base64Length: 19996,
  timestamp: 1761448186315
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 0/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19996
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_197_1761448186836',
  base64Length: 19880,
  timestamp: 1761448186839
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 1/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19880
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_198_1761448187355',
  base64Length: 19480,
  timestamp: 1761448187357
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 2/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19480
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_199_1761448187871',
  base64Length: 19612,
  timestamp: 1761448187873
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"-5D9aMuePKPnqtsPjcGPuAg"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 3/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19612
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_200_1761448188387',
  base64Length: 27528,
  timestamp: 1761448188390
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_JD9aPH6H6jgz7IP25TbwAk"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 4/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 27528
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_201_1761448188903',
  base64Length: 32304,
  timestamp: 1761448188904
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_ZD9aIjnBqLXz7IP-s7VMQ"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 5/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32304
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_ZD9aI7BEer9qtsP-u2h-A8"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_202_1761448189421',
  base64Length: 32204,
  timestamp: 1761448189422
}
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_203_1761448189939',
  base64Length: 32452,
  timestamp: 1761448189942
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"holding\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":20,"totalTokenCount":787,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_pD9aObrBeGJz7IPkb27gAw"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"holding"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"none","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ⚠️ Wrong action: none, expected placing_in_trolley
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 6/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32452
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 7/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32204
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_204_1761448190455',
  base64Length: 32704,
  timestamp: 1761448190457
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"holding\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":20,"totalTokenCount":787,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_pD9aMSzIqDUz7IPv4PK4AY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"holding"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"none","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ⚠️ Wrong action: none, expected placing_in_trolley
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 8/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32704
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_205_1761448190971',
  base64Length: 32852,
  timestamp: 1761448190973
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 9/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32852
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"holding\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":20,"totalTokenCount":787,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_5D9aNj2E--tz7IPhOf56AE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"holding"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"none","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ⚠️ Wrong action: none, expected placing_in_trolley
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"holding\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":20,"totalTokenCount":787,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_5D9aLbOGaPnqtsPh8GPuAg"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"holding"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"none","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ⚠️ Wrong action: none, expected placing_in_trolley
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_206_1761448191482',
  base64Length: 32960,
  timestamp: 1761448191483
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 10/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32960
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"holding\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":20,"totalTokenCount":787,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"_5D9aNiTLbGtz7IP-6bI4QE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"holding"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"none","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ⚠️ Wrong action: none, expected placing_in_trolley
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_207_1761448192006',
  base64Length: 32812,
  timestamp: 1761448192008
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 11/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32812
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_208_1761448192523',
  base64Length: 32812,
  timestamp: 1761448192526
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 12/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32812
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"holding\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":20,"totalTokenCount":787,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"AJH9aPbdNNysmtkP25-MoAs"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"holding"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"none","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ⚠️ Wrong action: none, expected placing_in_trolley
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"AZH9aLlno-eq2w__wI-4CA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_209_1761448193056',
  base64Length: 33060,
  timestamp: 1761448193057
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 13/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 33060
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_210_1761448193573',
  base64Length: 32912,
  timestamp: 1761448193575
}
[WS] ✅ Producto NUEVO registrado: Takis (confidence: 0.95)
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 14/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32912
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"AZH9aMaUMafiz7IP2vy8SQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_211_1761448194090',
  base64Length: 32960,
  timestamp: 1761448194092
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 15/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32960
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"ApH9aPrQFbbhz7IPlfamyAY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_212_1761448194605',
  base64Length: 33060,
  timestamp: 1761448194607
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"ApH9aLupKoKIqtsP5NO3oAg"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 16/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 33060
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_213_1761448195123',
  base64Length: 33056,
  timestamp: 1761448195125
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"A5H9aMTtD-HUz7IPy8SQsAU"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_214_1761448195640',
  base64Length: 32664,
  timestamp: 1761448195642
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"holding\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":20,"totalTokenCount":787,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"A5H9aNWqM_eDmtkP2dGviAc"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"holding"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"none","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ⚠️ Wrong action: none, expected placing_in_trolley
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 17/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32664
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 18/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 33056
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_215_1761448196155',
  base64Length: 32428,
  timestamp: 1761448196157
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 19/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32428
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"holding\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":20,"totalTokenCount":787,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BJH9aLvpFs2oqtsPqYs3"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"holding"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"none","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ⚠️ Wrong action: none, expected placing_in_trolley
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_216_1761448196674',
  base64Length: 32212,
  timestamp: 1761448196676
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 20/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32212
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_217_1761448197190',
  base64Length: 32536,
  timestamp: 1761448197192
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BZH9aIiNDKPnqtsPh8GPuAg"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 21/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32536
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BZH9aO2gFoLoz7IPoODXoQU"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"holding\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":20,"totalTokenCount":787,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BZH9aN_sH4DVz7IPmrDmMQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"holding"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"none","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ⚠️ Wrong action: none, expected placing_in_trolley
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_218_1761448197706',
  base64Length: 32364,
  timestamp: 1761448197708
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 22/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 32364
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_219_1761448198222',
  base64Length: 22816,
  timestamp: 1761448198223
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 23/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 22816
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BpH9aPPwHf_4qtsPt5OXsAc"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"holding\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":20,"totalTokenCount":787,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"BpH9aMbdJKGJqtsPlp23-A8"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"holding"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"none","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ⚠️ Wrong action: none, expected placing_in_trolley
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_220_1761448198740',
  base64Length: 19140,
  timestamp: 1761448198742
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 24/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19140
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_221_1761448199256',
  base64Length: 19152,
  timestamp: 1761448199258
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"B5H9aLeeFMXRz7IPzsTKMA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 25/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19152
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.85}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"B5H9aO3ZJZngz7IPh7q2KA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.85}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.85,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.85}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.85,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.85 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.85,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.85 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_222_1761448199771',
  base64Length: 21548,
  timestamp: 1761448199774
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 26/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21548
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"CJH9aIirC7bnqtsP5LOfgAs"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_223_1761448200288',
  base64Length: 23516,
  timestamp: 1761448200290
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 27/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23516
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"CJH9aJ7rK72fz7IPvO32uQU"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_224_1761448200807',
  base64Length: 23792,
  timestamp: 1761448200809
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 28/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23792
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_225_1761448201323',
  base64Length: 23816,
  timestamp: 1761448201325
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"CZH9aLPfFrvQz7IPxoi3UA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 29/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23816
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] ✅ Producto NUEVO registrado: Coca-Cola Regular Lata (confidence: 0.95)
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"CZH9aPXaL-6mmtkP8ciz4AE"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_226_1761448201832',
  base64Length: 23720,
  timestamp: 1761448201833
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 30/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23720
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_227_1761448202356',
  base64Length: 23004,
  timestamp: 1761448202358
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"CpH9aKPbGuCfz7IPzsa50AY"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 31/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 23004
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_228_1761448202873',
  base64Length: 24408,
  timestamp: 1761448202875
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"CpH9aNejNonRz7IPnKTY-AM"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 32/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 24408
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_229_1761448203390',
  base64Length: 25916,
  timestamp: 1761448203392
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"C5H9aPjxIsaCmtkP0cvV-A8"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 33/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 25916
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_230_1761448203901',
  base64Length: 26236,
  timestamp: 1761448203901
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Coca-Cola Regular Lata\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":24,"totalTokenCount":791,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DJH9aOeWA--tz7IPiov-yA8"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Coca-Cola Regular Lata","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Coca-Cola Regular Lata","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Coca-Cola Regular Lata',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Coca-Cola Regular Lata', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Coca-Cola Regular Lata ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 34/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26236
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_231_1761448204423',
  base64Length: 26468,
  timestamp: 1761448204424
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DJH9aOOpIojQz7IPjoTIOQ"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] 🆕 Productos NUEVOS a registrar: 1/1
[WS] 🗑️ Productos removidos del frame: 1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 35/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26468
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_232_1761448204940',
  base64Length: 26248,
  timestamp: 1761448204942
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] ✅ Producto NUEVO registrado: Takis (confidence: 0.95)
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DZH9aMiZDYKIqtsP5NO3oAg"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 36/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26248
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_233_1761448205453',
  base64Length: 26392,
  timestamp: 1761448205454
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 37/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 26392
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DZH9aJX3JbvQz7IPxoi3UA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_234_1761448205974',
  base64Length: 21420,
  timestamp: 1761448205976
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 38/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 21420
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DpH9aMblE47oz7IP84bk4QU"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_235_1761448206492',
  base64Length: 19188,
  timestamp: 1761448206495
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 39/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19188
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"holding\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":20,"totalTokenCount":787,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"DpH9aOGMLc2oqtsPqYs3"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"holding"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"none","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ⚠️ Wrong action: none, expected placing_in_trolley
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_236_1761448207007',
  base64Length: 19428,
  timestamp: 1761448207009
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 40/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19428
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.95}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"D5H9aJWREb7oz7IPsdSAeA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.95}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.95,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.95}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.95,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.95 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_237_1761448207524',
  base64Length: 19460,
  timestamp: 1761448207526
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 41/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19460
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_238_1761448208057',
  base64Length: 19868,
  timestamp: 1761448208059
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[{\"name\":\"Takis\",\"confidence\":0.85}],\"action\":\"placing\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":21,"totalTokenCount":788,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"EJH9aOeEB5z4qtsPjPa1EA"}
[Gemini] 📄 Texto extraído: {"items":[{"name":"Takis","confidence":0.85}],"action":"placing"}
[Gemini] 🔍 Parsed result: {"detected":true,"product_name":"Takis","confidence":0.85,"action":"placing_in_trolley","all_items":[{"name":"Takis","confidence":0.85}]}
[Gemini] ✅ Detección válida: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.85,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.85 } ]
}
[WS] 🔍 Resultado de Gemini: {
  detected: true,
  product_name: 'Takis',
  confidence: 0.85,
  action: 'placing_in_trolley',
  all_items: [ { name: 'Takis', confidence: 0.85 } ]
}
[WS] 📦 Items detectados en frame actual: 1
[WS] ♻️ Takis ya está visible - NO se registra de nuevo
[WS] 🆕 Productos NUEVOS a registrar: 0/1
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"EJH9aMuADvHoz7IP_OSyQQ"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 42/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19868
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_239_1761448208574',
  base64Length: 19776,
  timestamp: 1761448208576
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"EJH9aNeOJ9bZqtsP34Cc4QE"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 43/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 19776
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_240_1761448209089',
  base64Length: 20040,
  timestamp: 1761448209090
}
[WS] ✅ Scan válido, obteniendo catálogo...
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"EZH9aJ2FD57oz7IP06qvaQ"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 44/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20040
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"EZH9aIbNG6vTz7IP8eHrOQ"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_241_1761448209607',
  base64Length: 20232,
  timestamp: 1761448209609
}
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 45/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20232
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_242_1761448210123',
  base64Length: 20272,
  timestamp: 1761448210125
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"EpH9aIfoCtqKqtsP---xwAg"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 46/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20272
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] 📥 Frame recibido del cliente
[WS] 📊 Datos del frame: {
  scanId: 17,
  frameId: 'frame_243_1761448210658',
  base64Length: 20256,
  timestamp: 1761448210660
}
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"EpH9aJXzJOzPz7IPhquwkAI"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[WS] ✅ Scan válido, obteniendo catálogo...
[WS] 🧹 Tracking de productos visibles limpiado para scan 17
[WS] Scan 17 ended
[WS] 📦 Productos en catálogo: 20
[WS] 📊 Rate actual: 47/120 RPM
[WS] 🤖 Llamando a Gemini para análisis...
[Gemini] 🚀 Iniciando análisis con Gemini API
[Gemini] 📦 Catálogo: 20 productos
[Gemini] 📊 Base64 length: 20256
[Gemini] 📝 Prompt generado: Detecta SOLO productos que VES en la imagen. Catálogo:
Coca-Cola Regular Lata: Lata roja, anilla roja, logo "Coca-Cola" blanco
Coca-Cola Light Lata: Lata plateada/gris, aro rojo, texto "Light"
Coca-Co...
[Gemini] 📡 Enviando request a: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"E5H9aMfCDZbRz7IPu-jxMA"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"E5H9aOD7MLaeqtsPn-nJgQc"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[Gemini] 📥 Response status: 200
[Gemini] 📦 JSON response: {"candidates":[{"content":{"parts":[{"text":"{\"items\":[],\"action\":\"none\"}"}],"role":"model"},"finishReason":"STOP","index":0}],"usageMetadata":{"promptTokenCount":767,"candidatesTokenCount":8,"totalTokenCount":775,"promptTokensDetails":[{"modality":"TEXT","tokenCount":509},{"modality":"IMAGE","tokenCount":258}]},"modelVersion":"gemini-robotics-er-1.5-preview","responseId":"FJH9aPzPBIHQz7IPk5-8kQU"}
[Gemini] 📄 Texto extraído: {"items":[],"action":"none"}
[Gemini] 🔍 Parsed result: {"detected":false}
[Gemini] ✅ Detección válida: { detected: false }
[WS] 🔍 Resultado de Gemini: { detected: false }
[WS] ⚪ No se detectó producto o confianza baja
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node src/index.js`[39m
[Gemini] Configurado con modelo: gemini-robotics-er-1.5-preview
[Gemini] URL: https://generativelanguage.googleapis.com/v1beta/models/gemini-robotics-er-1.5-preview:generateContent
[WS] Video stream namespace initialized at /ws

═══════════════════════════════════════════════════════
🚀 Smart Trolley API Server
═══════════════════════════════════════════════════════
✅ Server running on http://localhost:3001
✅ WebSocket available at ws://localhost:3001/ws
✅ Gemini Mode: 🤖 REAL (Production)
✅ Database: 🟢 Connected
═══════════════════════════════════════════════════════

📡 Endpoints:
   GET  /                          - API info
   GET  /health                    - Health check
   GET  /api/trolleys/:id/realtime-status
   GET  /api/trolleys/:id/detections
   GET  /api/scans/:id/summary

🎥 WebSocket Events:
   start_scan  - Iniciar grabación
   frame       - Enviar frame de video
   end_scan    - Finalizar grabación

👀 Listening for connections...

[WS] No token provided, using guest user (dev mode)
[WS] User guest connected (gPFCCVeh5QRhCnV2AAAB)
